<!doctype html>
<html>
<head>
	<meta charset="gbk" />
	<script>
		if(/Android (\d+\.\d+)/.test(navigator.userAgent)){
			if(parseFloat(RegExp.$1)>2.3){
				var phoneScale = parseInt(window.screen.width)/640;
				document.write('<meta name="viewport" content="width=640, minimum-scale='+ phoneScale +', maximum-scale='+ phoneScale +', target-densitydpi=device-dpi" />');
			}else{
				document.write('<meta name="viewport" content="width=640, target-densitydpi=device-dpi" />');
			}
		}else{
			document.write('<meta name="viewport" content="width=640,user-scalable=no, target-densitydpi=device-dpi" />');
		}
	</script>
	<title>Z股神机 牛熊大战游戏开始</title>
	<link rel="stylesheet" href="http://active.zol.com.cn/15active/0604gs/gushen.css" />
	<style type="text/css">
	.loading{position: absolute; z-index: 1001; opacity: 0; pointer-events: none; width: 200px; height: 180px; left: 50%; top: 50%; margin: -100px 0 0 -90px; background: rgba(0,0,0,.8);-webkit-transition: opacity .2s linear;transition: opacity .2s linear;-webkit-border-radius: 20px; border-radius: 20px; }
	.loading:before{margin:20px 0 0 20px; content:"";width: 160px; height: 140px; display: block; -webkit-border-radius: 8px; border-radius: 8px; background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAVFBMVEX///////////////////////////////////////////////////////////////////////////////////////////////////////////////+UMeA9AAAAG3RSTlMAAgQQIDA9QEpMUGBwfICQlKCssMDE0Nzg8PQ1V+FjAAABn0lEQVR4Xq3W227DIBAE0HWA0rrYNIFSHP7/P3sxLsrOkiKlI0V5yYnG1nIhKWYNudTk4AwNRftcWLLXfzIbi5ho7zLdGFKN4Gm5pJ9cy51cU81b6/f9WWMZy/bS4PHtwvY3nC2De4w757vuTBy26Nc+zopBHjX7JEFLCBHjG/MEUI7jRW/gS9cZKHoD37swYVGi5XC29NwqFCVKR9fYg5YVNbVG3J0uHajYJKy//fd59z3ob12iA9ZnzQjlog3m+sZFqDYsWuH+J64DAxZt0NUfCG4WijYY9kcsg0UbzERURMiGO/JxIpoQ4mxvmsOJThLUrKgjDk8A5aKDcIWiY9AULIpwQpigKMKJCKDHoghhAHC2ZxJghpGDRRhIggGGHIoqETpYVjMUFaHhC1ltUFSCGbaOAEVF6PlmhUVlqNn2yGfbkwwj35Aj7L8ytOwIcHBQyFnYoTNYFI+5BEXH4ApFx6ApPHG1A1AlgIgRstkGrLrQlvtJflYSZIuwjzk8VzCGG3xORz765iPVXJYHLroPXK0fvsxjptNXJvr3fAJQqYYOskEC/AAAAABJRU5ErkJggg==) no-repeat 50% 50%; }
	.loading-ring { display: block; position: absolute; width: 96px; height: 96px; left: 50%; top: 50%; margin: -48px 0 0 -48px; -webkit-animation: loaing-animation linear 1s infinite; animation: loaing-animation linear 1s infinite; background: url(data:image/png;base64,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) no-repeat 0 0; -webkit-background-size: 100% 100%; background-size: 100% 100%; }
	.loading-visible { opacity: 1;}

	@-webkit-keyframes loaing-animation {
		0% { -webkit-transform: rotate(0deg); }
		100% { -webkit-transform: rotate(360deg); }
	}

	@keyframes loaing-animation {
		0% { transform: rotate(0deg); }
		100% { transform: rotate(360deg); }
	}
	</style>
</head>
<body id="game">
	<div class="loading loading-visible" id="loading">
    	<span class="loading-ring"></span>
    </div>
	<!-- header -->
	<header class="g-header">
		<h2 class="logo">中关村在线</h2>
		<h1 class="logo-gushen">一代炒股神器问世Z股神</h1>
	</header>

	<!-- tips -->
	<div id="gTips" class="g-tips">
		<div class="g-tips-main">
			<h3>秘籍</h3>
			<p>一根手指快速点击买入，<br />指数会涨得更快！</p>
			<div class="countdown">
				<div class="cricle"></div>
				<div class="number number1"></div>
				<div class="number number2"></div>
				<div class="number number3"></div>
				<div class="number number4"></div>
			</div>
		</div>
	</div>

	<!-- main -->
	<section class="g-main">
		<div class="g-main-bg">
			<canvas id="drawing" width="584" height="722"></canvas>
			<canvas id="mark" width="584" height="722"></canvas>
		</div>
		
		<div id="button">买入</div>
		<div class="title">Z股神指数</div>
	</section>

	<!-- Modal -->
	<div id="modal" class="modal" role="dialog" aria-hidden="true">
		<div class="modal-bg">
			<div class="modal-content">
				<div class="modal-error">
					<h1>股神大人</h1>
					<p>
						掐指一算您的手速已成仙<br />
						为保证游戏公平性<br />
						此游戏需要真实点击
					</p>
					<div class="g-button g-game-again">再玩一次</div>
				</div>
			</div>
		</div>
	</div>

<script src="http://icon.zol-img.com.cn/wap/js/z.min.js"></script>
<script src="http://icon.zol-img.com.cn/m/js/wechat-share.1.1.js"></script>
<script type="text/javascript">
window.addEventListener('load',function(){
	loading.classList.remove('loading-visible');
})
// 这个是微信分享的图片路径和title，图片尺寸限制为300x300
window.WeixinShareData = {
	'icon':'http://2.zol-img.com.cn/zt/tm_557/024ac0345f/weixin.jpg',
	'title':'Z股神机 牛熊大战有奖游戏'
};
define(function (require,exports){
	var gMain = document.querySelector('.g-main'),
		modalSuccess = document.querySelector('.modal-success'),
		modalError = document.querySelector('.modal-error');

	//再玩一次
	document.querySelector('.g-game-again').addEventListener('tap', function(){
		window.location.reload();
	});

	//是否支持getContext
	if (drawing.getContext) {
		var context = drawing.getContext('2d');
		var context2 = mark.getContext('2d');

		// 设置全局描边和填充
		context.strokeStyle = '#4e5464';
		context.fillStyle = '#4e5464';
		// context.translate(0.5, 0.5);// fix 1px width -- http://www.jb51.net/html5/95741.html
		context.lineWidth = 1;

		//股神图片
		var guImg = new Image();
		guImg.src = 'http://2.zol-img.com.cn/zt/tm_557/024ac0345f/gushen.png';

		guImg.addEventListener('load', function(){
			//开始路径
			context.beginPath();
			
			//绘制横线
			context.moveTo(0.5, 682.5);
			context.lineTo(568.5, 682.5);
			
			context.moveTo(0.5, 598.5);
			context.lineTo(568.5, 598.5);
			
			context.moveTo(0.5, 518.5);
			context.lineTo(568.5, 518.5);
			
			context.moveTo(0.5, 438.5);
			context.lineTo(568.5, 438.5);
			
			context.moveTo(0.5, 358.5);
			context.lineTo(568.5, 358.5);
			
			context.moveTo(0.5, 278.5);
			context.lineTo(568.5, 278.5);
			
			context.moveTo(0.5, 198.5);
			context.lineTo(568.5, 198.5);
			
			context.moveTo(0.5, 118.5);
			context.lineTo(568.5, 118.5);


			//绘制竖线
			context.moveTo(55.5, 692.5);
			context.lineTo(55.5, 82.5);

			context.moveTo(220.5, 692.5);
			context.lineTo(220.5, 82.5);

			context.moveTo(385.5, 692.5);
			context.lineTo(385.5, 82.5);

			context.moveTo(548.5, 692.5);
			context.lineTo(548.5, 82.5);


			//描边路径
			context.stroke();


			//绘制文本
			context.font = '700 30px Arial';
			context.textAlign = 'center';
			context.textBaseline = 'middle';
			context.fillStyle = 'rgba(255,255,255,.8)';
			
			context.fillText('0', 55, 706);
			context.fillText('5', 220, 706);
			context.fillText('10', 385, 706);
			context.fillText('15', 550, 706);

			context.font = '400 22px Arial';
			context.textAlign = 'middle';
			context.textBaseline = 'top';
			context.fillStyle = 'rgba(255,255,255,.4)';

			context.fillText('500', 28, 598);
			context.fillText('1000', 28, 518);
			context.fillText('2000', 28, 438);
			context.fillText('3000', 28, 358);
			context.fillText('4000', 28, 278);
			context.fillText('5000', 28, 198);
			context.fillText('6000', 28, 118);


			//设置曲线样式
			var i = 0;
			var aX = 55, aY = 518;
			var rectX = 165, rectY = 80;

			context.strokeStyle = 'rgba(212,0,0,.9)';
			context.lineWidth = 5;
			context.lineCap = 'round';


			//点击次数
			var num = 0;
			//定义date
			var date = 0;
			//数组存放aY
			var aYList = [];
			var aYMax = 0;

			
			if (gTips) {
				gTips.classList.add('visible');

				//关闭引导层
				gTips.querySelector('.number4').addEventListener('webkitAnimationEnd', function(){
					gTips.classList.remove('visible');
					gMain.classList.add('visible');

					//不点击时下降
					var timer = setInterval(function(){
						context.beginPath();
						//绘制图片
						context2.drawImage(guImg, aX-36, aY-60, 72, 182);
						context.moveTo(aX, aY);
						aX = aX + rectX/(5*20);
						aY = aY + rectY/2/(5*20);
						context.lineTo(aX, aY);
						context.stroke();
						context2.clearRect(aX-72, aY-182, 72*2, 182*2);
						context2.drawImage(guImg, aX-36, aY-91, 72, 182);

						if (aY >= 598) {
							modal.classList.add('active');
							modalError.classList.add('active');
							modalError.querySelector('p').innerHTML = '疯狂点击买入吧！';
							clearInterval(timer);
						};
						//获取第一次点击前的时间
						date = new Date().getTime();
					},50);


					//点击函数
					var run = function(){
						//开始点击清楚自动下降
						clearInterval(timer);

						//获取点击时间
						var clickDate = new Date().getTime();
						var wTime = clickDate - date;
						//每次点击X轴增加
						//console.log(wTime);
						var eX = rectX*(wTime/5000);
						//每次点击Y轴上升,点击上升upY,1秒下降downY
						var eY = 0, upY = 55, downY = 0;
						//细分时间间隔
						switch(true){
							case wTime < 130:
								downY = 500;
								break;
							case wTime >= 130 && wTime < 140:
								downY = 100;
								break;
							case wTime >= 140 && wTime < 150:
								downY = 150;
								break;
							case wTime >= 150 && wTime < 170:
								downY = 200;
								break;
							case wTime >= 170 && wTime < 180:
								downY = 250;
								break;
							case wTime >= 180 && wTime < 190:
								downY = 300;
								break;
							case wTime >= 190 && wTime < 200:
								downY = 350;
								break;
							case wTime >= 200 && wTime < 210:
								downY = 400;
								break;
							default:
								downY = 500;
								break;
						};
						eY = rectY/(1000/upY) - rectY/(1000/(downY*wTime/1000));

						//开始绘图
						context.beginPath();
						context.moveTo(aX, aY);
						if (aY - eY > 682) {
							context.lineTo(aX+eX, 682);
						} else {
							context.lineTo(aX+eX, aY-eY);
						};
						
						context.stroke();

						//绘制图像
						context2.clearRect(aX-72, aY-182, 72*2, 182*2);
						context2.drawImage(guImg, aX+eX-36, aY-eY-91, 72, 182);

						//重新获取当前时间以及坐标
						date = new Date().getTime();
						aX = aX + eX;
						if (aY - eY > 682) {
							aY = 682;
						} else {
							aY = aY - eY;
						};

						//获取aY的最大值
						aYList.push(aY);
						aYMax = Math.min.apply(null, aYList);
						
						num++;
					};


					//绑定点击事件
					button.addEventListener('tap', run);

					
					//全部时间返回结果
					setTimeout(function () {

						//未点击
						if (aYMax.length === 0) {
							aYMax = 1000;
						} else {
							aYMax = parseInt(1000+5000*((518-aYMax)/400));
							//作弊
							if (aYMax > 6000) {
								modal.classList.add('active');
								modalError.classList.add('active');
							} else {
								if (aYMax < 1000) {
									aYMax = 1000;
								};
								//console.log(aYMax);
								localStorage.setItem('score',aYMax);
								location.href = 'http://m.zol.com.cn/topic/5244767.html';
							};
						};
						
						//取消点击事件
						button.removeEventListener('tap', run);
						clearInterval(timer);
					}, 15000);

				});
			};
			
		});

	};

});
// if (document.referrer!='http://m.zol.com.cn/topic/5243820.html') {
// 	window.location.href = 'http://m.zol.com.cn/topic/5243757.html';
// };
</script>
</body>
</html>